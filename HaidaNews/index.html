<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <title></title>
    <script src="js/mui.min.js"></script>
    <script src="Classes/Others/Request/request.js"></script>
    <link href="css/mui.min.css" rel="stylesheet"/>
    <script type="text/javascript" charset="utf-8">
      	mui.init();
     	

    </script>
</head>
<body>
	<header class="mui-bar mui-bar-nav">
	    <a class="mui-icon mui-icon-list" id="leftList"></a>
	    <h1 class="mui-title">首页</h1>
	</header>
		<nav class="mui-bar mui-bar-tab" id="nav_tab">
    		<a class="mui-tab-item mui-active" href="Classes/Home/home.html">
    			<span class="mui-icon mui-icon-home"></span>
    			<span class="mui-tab-label">首页</span>
    		</a>
 	    <a class="mui-tab-item" href="Classes/News_Collection/news_collection.html" >
 	    			<span class="mui-icon mui-icon-star"></span>
    				<span class="mui-tab-label">收藏</span>

    		</a>
    		<a class="mui-tab-item" href="Classes/Provision/provision.html" >
    				<span class="mui-icon mui-icon-more"></span>
    			    <span class="mui-tab-label">暂定</span>	
    		
    		</a>
    	
    </nav>
	
<script type="text/javascript">		
		//设置默认打开首页显示的子页序号；
		var Index=0;
		//把子页的路径写在数组里面
		var subpages = ['Classes/Home/home.html','Classes/News_Collection/news_collection.html','Classes/Provision/provision.html'];
		//所有的plus-*方法写在mui.plusReady中或者后面。
		mui.plusReady(function() {
			

			
			//获取当前页面所属的Webview窗口对象
			var self = plus.webview.currentWebview();
			for (var i = 0; i < subpages.length; i++) {
				//创建webview子页
				var sub = plus.webview.create(
					subpages[i], //子页url
					subpages[i], //子页id
					{
						top: '45px',//设置距离顶部的距离
						bottom: '50px'//设置距离底部的距离
					}
				);
				//如不是我们设置的默认的子页则隐藏，否则添加到窗口中
				if (i != Index) {
					sub.hide();
				}
				//将webview对象填充到窗口
				self.append(sub);
			}
		});
		
		//当前激活选项
		var activeTab = subpages[Index],title=document.querySelector(".mui-title");
		//选项卡点击事件
		mui('.mui-bar-tab').on('tap', 'a', function(e) {
			//获取目标子页的id
			var targetTab = this.getAttribute('href');
			if (targetTab == activeTab) {
				return;
			}
			//更换标题
			title.innerHTML = this.querySelector('.mui-tab-label').innerHTML;
			//显示目标选项卡
			plus.webview.show(targetTab);
			//隐藏当前选项卡
			plus.webview.hide(activeTab);
			//更改当前活跃的选项卡
			activeTab = targetTab;
		});
		
		document.getElementById("leftList").addEventListener('tap',function () {
				//更多
				showSide();
			});
			
		var main = null;
		var mainstart = window.mainstart;
		var showmain = window.showmain;
		if(showmain == null && mainstart==null)
		{
			showmain = false;
			mainstart = false;
		}
		var	wc=plus.webview.create("Classes/LeftList/leftList.html","leftList",{top:"0",bottom:"0",width:"50%"});

		function showSide(){
			// 防止快速点击可能导致多次创建


			main = plus.webview.getWebviewById(plus.runtime.appid);
			if(!mainstart){
				main.addEventListener('maskClick',showSide);
				mainstart=true;
			}
			if(showmain){
				
				main.setStyle({
					mask: 'none',
					left: '0',
					transition: {
						duration: 100
					}
					});

				wc.hide();
//				plus.webview.close(wc);
				showmain = false;
			}
			else
			{
				// 创建侧滑页面
				// 侧滑页面加载后显示（避免白屏）
				showmain = true;
				wc.show('slide-in-left',200);
//				plus.webview.open(wc);
				main.setStyle({
						mask: 'rgba(0,0,0,0.2)',
						//left: '70%',
						transition: {
							duration: 150
						}
				});
				
				
			}


		}
			window.addEventListener('refresh', function(e) {  
				var homePage = plus.webview.getWebviewById(subpages[0]);
				mui.fire(homePage,'refreshDown');
    		});
</script>
	
</body>
	
	
</html>